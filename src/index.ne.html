<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="http://lib.baomitu.com/jquery/1.12.4/jquery.js"></script>
    <script src="http://lib.baomitu.com/angular.js/1.7.5/angular.js"></script>
    <script src="http://lib.baomitu.com/angular.js/1.7.5/angular-sanitize.js"></script>
    <!-- jplayer音频插件css -->
    <link href="aud/zh/myplayer/MPlayer.css" rel="stylesheet" />
    <link rel="stylesheet" href="aud/med/JQuery.LgKyMediaPlayer.css" />
    <!-- Vlc音频插件css -->
    <!-- <link rel="stylesheet" href="aud//vlc/vlc-audio.css" /> -->
    <!-- jplayer音频播放器插件js -->
    <script src="aud/zh/BrowerInfo.gxhfx.js"></script>
    <script src="aud/zh/jquery.jplayer.min.js"></script>
    <script src="aud/zh/myplayer/MPlayer.js"></script>
    <script src="aud/med/JQuery.LgKyMediaPlayer.js"></script>
  </head>
  <body>
    <div ng-app="app">
      <div ng-controller="ctrl" ng-init="page()">
        <!--
          <object
            type="application/x-vlc-plugin"
            id="vlc"
            events="false"
            width="700"
            height="400"
            pluginspage="http://www.videolan.org"
            codebase="http://downloads.videolan.org/pub/videolan/vlc-webplugins/2.0.6/npapi-vlc-2.0.6.tar.xz"
          >
            <param id="vlcmrl" name="mrl" value="" />
            <param name="volume" value="50" />
            <param name="autoplay" value="false" />
            <param name="loop" value="false" />
            <param name="fullscreen" value="false" />
          </object>
        -->
        <object
          type="application/x-vlc-plugin"
          id="pfvlc"
          events="True"
          classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921"
          class="vd-screen"
        >
          <param name="mrl" value="" /> <param name="volume" value="80" />
          <param name="autoplay" value="false" />
          <param name="mute" value="true" />
          <param name="loop" value="false" />
          <param name="toolbar" value="false" />
          <param name="fullscreen" value="false" />
        </object>
        <div id="id_mediaPlayer_quesArticle0" class="dv-audio"></div>
        <div id="id_mediaPlayer_quesArticle1" class="dv-audio"></div>
        <div id="id_mediaPlayer_quesArticle2" class="dv-audio"></div>
        <!--
          <div id="audio00"></div>
          <div id="audio01"></div>
          <div id="audio02"></div>
        -->
      </div>
    </div>
  </body>
  <script>
    // var vlc = document.getElementById("vlc");
    // var velFlag = 0; //是否静音状态
    // var mp3box = ["mp3/2018.mp3","mp3/error.wav","mp3/wlw.wmv"]
    // var eT; //定时器
    // var sT; //定时器
    // function play(id) {
    //   vlc.playlist.clear(); //清空播放列表
    //   //alert(vlc.playlist.isPlaying); //当前音频是否播放
    //   var mp3id =parseInt(id.replace("play0",""));
    //   var sitem = vlc.playlist.add(mp3box[mp3id]); //插入播放的音频
    //   //alert(vlc.playlist.itemCount); //当且播放列表的个数
    //   if (vlc.playlist.isPlaying == false) {
    //     $("#" + id).removeClass("play"); //改变样式
    //     $("#" + id).addClass("Pause"); //改变样式
    //     vlc.playlist.playItem(sitem);
    //     //vlc.playlist.play(); //音频播放
    //     //alert(vlc.playlist.isPlaying)//当前音频是否播放
    //     //jdt(id); //进度条动起来
    //    }else if (vlc.playlist.isPlaying == true) {
    //     //判断状态
    //     $("#" + id).removeClass("Pause");
    //     $("#" + id).addClass("play");
    //     vlc.playlist.togglePause(); //音频暂停
    //     //rmjdt(); //进度条暂停
    //    }
    // }
    // function stop(id) {
    //   //重新播放
    //   id = id.replace("stop", "");
    //   vlc.playlist.stop();
    //   rmjdt();
    //   playFlag = 0;
    //   $("#play" + id).removeClass("Pause");
    //   $("#play" + id).addClass("play");
    //   $("#StartTime" + id).html("00:00");
    //   $(".jdt" + id).css({ width: "0px" });
    // }
    // function jdt(id) {
    //   //进度条
    //   //起一个定时器
    //   id = id.replace("play", "");
    //   eT = window.setTimeout(function() {
    //     var EndTime = dateFtt(vlc.input.length); //音频总长度
    //     $("#EndTime" + id).html(EndTime);
    //   }, 100);
    //   sT = window.setInterval(function() {
    //     var StartTime = dateFtt(vlc.input.time);
    //     $("#StartTime" + id).html(StartTime);
    //     var x = (vlc.input.time / vlc.input.length) * 200;
    //     $(".jdt" + id).css({ width: x + "px" });
    //     if (vlc.input.time >= vlc.input.length - 100) {
    //       //stop(id);
    //     }
    //   }, 10);
    // }
    // function rmjdt() {
    //   //暂停进度条
    //   //关闭一个定时器
    //   window.setTimeout(eT);
    //   window.clearInterval(sT);
    // }
    // function mute(id) {
    //   id = id.replace("ismute", "");
    //   if (velFlag == 0) {
    //     vlc.audio.volume = 0;
    //     $("#ismute" + id).removeClass("Nomute"); //喇叭的样式
    //     $("#ismute" + id).addClass("mute"); //喇叭的样式
    //     $(".vol" + id).css({ width: "0px" }); //音频的蓝色进度条
    //     velFlag = 1;
    //   } else if (velFlag == 1) {
    //     vlc.audio.volume = 50;
    //     $("#ismute" + id).removeClass("mute");
    //     $("#ismute" + id).addClass("Nomute");
    //     velFlag = 0;
    //     $(".vol" + id).css({ width: "37px" }); //音频的蓝色进度条
    //   }
    // }
    // function dateFtt(fmt) {
    //   //时间格式化
    //   var d = new Date(fmt);
    //   var minute = change(d.getMinutes());
    //   var second = change(d.getSeconds());
    //   function change(t) {
    //     if (t < 10) {
    //       return "0" + t;
    //     } else {
    //       return t;
    //     }
    //   }
    //   var time = minute + ":" + second;
    //   return time;
    // }

    var app = angular.module("app", ["ngSanitize"]);
    app.controller("ctrl", function($scope, $interval) {
      $scope.page = function() {
        $scope.x = ["mp3/2018.mp3", "mp3/2018.wav", "mp3/error.wav"];
        ZnbkPlayer();
        //初始化音频
      };
      //判断浏览器的方法
      var ZnbkPlayer = function() {
        // $scope.id = "00";
        // $scope.vlcurl = "mp3/2018.mp3";
        // var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
        // var isIE_flag = 0; //flag为1的时候，是IE浏览器，否则不是
        // var isIE =
        //   userAgent.indexOf("compatible") > -1 &&
        //   userAgent.indexOf("MSIE") > -1; //判断是否IE<11浏览器
        // var isEdge = userAgent.indexOf("Edge") > -1 && !isIE; //判断是否IE的Edge浏览器
        // var isIE11 =
        //   userAgent.indexOf("Trident") > -1 &&
        //   userAgent.indexOf("rv:11.0") > -1;
        // if (isIE) {
        //   var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
        //   reIE.test(userAgent);
        // var fIEVersion = parseFloat(RegExp["$1"]);
        // if(fIEVersion == 7) {
        //     alert("7");
        // } else if(fIEVersion == 8) {
        //     alert("8");
        // } else if(fIEVersion == 9) {
        //     alert("9");
        // } else if(fIEVersion == 10) {
        //     alert("10");
        // } else {
        //     alert("6");
        // }
        //是否是IE7 8 9 10版本
        //   isIE_flag = 1;
        // } else if (isEdge) {
        //   //是否是EDG浏览器
        //   isIE_flag = 0;
        // } else if (isIE11) {
        //   //是否是IE11
        //   isIE_flag = 1;
        // } else {
        //   //是否是其他浏览器
        //   isIE_flag = 0;
        // }
        // ///////  以上是判断浏览器
        // ///////
        // ///////
        // /////// 以下是不同浏览器启用不同方法
        // if (isIE_flag == 2) {
        //   //获取页面的ID容器
        //   for (var i = 0; i < 3; i++) {
        //     $scope.id = "0" + i;
        //     addhtml();
        //   }
        // } else if (isIE_flag == 1 || isIE_flag ==0) {
        InitAudioPlay(0);
        InitAudioPlay(1);
        InitAudioPlay(2);
        // }
      };

      // var addhtml = function() {
      //   document.getElementById("audio" + $scope.id).innerHTML =
      //     "<div class='vlcBox'>" +
      //     "<button id='play" +
      //     $scope.id +
      //     "'class='play' onclick='play(id)'></button>" +
      //     "<button id='stop" +
      //     $scope.id +
      //     "' class='stop' onclick='stop(id)'></button>" +
      //     "<div class='jdtbg'><div class='jdt jdt" +
      //     $scope.id +
      //     "'></div></div>" +
      //     "<div class='time'>" +
      //     "<span id='StartTime" +
      //     $scope.id +
      //     "'>00:00</span><span>/</span>" +
      //     "<span id='EndTime" +
      //     $scope.id +
      //     "'>00:00</span>" +
      //     "</div>" +
      //     "<button id='ismute" +
      //     $scope.id +
      //     "' class='Nomute' onclick='mute(id)'></button>" +
      //     "<div class='volbg'><div class='vol vol" +
      //     $scope.id +
      //     "'></div></div>" +
      //     "</div>";
      // };
      // var initAudioPlay = function(typeIndex, quesIndex) {
      //   var id = "#audio" + typeIndex + quesIndex;
      //   if ($(id).children().length == 0) {
      //     $(id)
      //       .children()
      //       .remove(); //删除原有节点的内容，再重新添加新的播放器
      //     var options = {
      //       PlayerName: "aboutplayer" + typeIndex + quesIndex,
      //       FootDiv: "playPanelNew" + typeIndex + quesIndex,
      //       sJplayerID: "#id_jplayer" + typeIndex + quesIndex,
      //       nIndex: typeIndex.toString() + quesIndex.toString(),
      //       PlayPath: $scope.x[quesIndex],
      //       AppendId: id,
      //       sJplayerDocument: "id_PlayControl" + typeIndex + quesIndex,
      //       sImagePath: ""
      //     };

      //     $("#id_PlayControl" + typeIndex + quesIndex).MPlayer(options);
      //     console.log($scope.x[quesIndex]);
      //   }
      // };
      //初始化音频播放
      var InitAudioPlay = function(CurrentIndex) {
        var idStr = "#id_mediaPlayer_quesArticle" + CurrentIndex;

        if ($(idStr).children().length == 0) {
          //删除主节点下所有的子节点
          $(idStr)
            .children()
            .remove();

          var options = {
            PlayerName: "aboutplayer" + CurrentIndex,
            FootDiv: "playPanelNew" + CurrentIndex,
            sJplayerID: "#id_jplayer" + CurrentIndex,
            nIndex: CurrentIndex,
            PlayPath: $scope.x[CurrentIndex],
            AppendId: idStr,
            sJplayerDocument: "id_PlayControl" + CurrentIndex
          };

          $("#id_PlayControl" + CurrentIndex).MPlayer(options);
        }
      };

      //初始化VLC视频播放器
      var InitVLCPlayer = function() {
        
        $scope.VideoTime = null; //存放视频播放计时器
        $scope.TitleTime = null; //字幕定时器
        $scope.VideoPageArr = {
          src: "", //资料路径
          srcType: "", //资料类型
          //totalTime: , //视频播放总时长
          pDragFlag: false, //进度拖动
          vDragFlag: false, //音量拖动
          isPlaying: 0, //是否已经加载播放过
          isFullScreen: false, //是否全屏
          volume: 50, //音量默认为0.5
          nowTime: 0 //当前播放时长
        };
        //var baseUrl = ZNBKXX_PersonalFavourite.GetBaseUrl().value;
        $scope.VideoPageArr.src = ''
          //baseUrl + "/" + $scope.PageInfo.ResDetail.VedioList[0].AudioPath;
        $scope.VideoPageArr.srcType = GetFileBackName($scope.VideoPageArr.src);

        var vlc = document.getElementById("pfvlc");
        //if (typeof vlc.playlist == "undefined") {
        //    $(".ErrorContent").html("请升级VLC至<a href='http://www.videolan.org/'>最新版</a>或使用其他浏览器学习！");
        //    return;
        //}
        vlc.audio.mute = false; //设置vlc播放器的音量为非静音

        //初始化vlc播放器中的点击事件
        //浏览模式播放按钮点击事件
        $(".vc-play")
          .off("click")
          .click(function() {
            Func_Play_Event();
            $(".vc-play").hide();
          });
        //浏览模式暂停按钮点击事件
        $(".vc-pause")
          .off("click")
          .click(function() {
            Func_Pause_Event();
            $(".vc-play").show();
          });
        //浏览模式停止按钮点击事件
        $(".vc-stop")
          .off("click")
          .click(function() {
            Func_Stop_Event();
          });
        //静音按钮点击事件
        $(".vc-mute")
          .off("click")
          .click(function() {
            Func_Unmute_Event();
          });
        //取消静音按钮点击事件
        $(".vc-unmute")
          .off("click")
          .click(function() {
            Func_Mute_Event();
          });
        //进度条点击事件
        $("#pfvc-process")
          .off("click")
          .click(function(e) {
            Func_Process_Event(e);
          });
        //音量条点击事件
        $("#pfvc-volume-bar")
          .off("click")
          .click(function(e) {
            Func_Volume_Event(e);
          });
        //进度条/音量条拖动事件
        Func_PVDrag_Event();
        //增加全屏点击事件
        $("#pffullscreen")
          .off("click")
          .click(function() {
            Func_FullScreent_Event();
          });
        //如果是视文类的资源，增加字幕
        // if ($scope.PageInfo.ResDetail.ResType == "6") {
        //   //原文按钮点击事件
        //   $("#pfshowsubtitle")
        //     .off("click")
        //     .click(function() {
        //       Func_Subtitle_Event();
        //     });
        // }

        //$('#pfvlcShadow').css({ 'display': 'block' });
        //$('#pfvideoScreen').css({ 'visibility': 'hidden' });
      };
    });
  </script>
</html>
